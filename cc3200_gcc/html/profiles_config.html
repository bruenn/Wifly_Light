<!DOCTYPE html>
<!--[if lte IE 9 ]> <html class="ie"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html> <!--<![endif]-->

  <head>
    <link rel="stylesheet" type="text/css" href="simple_link.css">
    <script src="js/jquery-2.1.1.min.js"></script>
    <script type="text/javascript">

      var _count = 0;
      var _flag = 0;
      _tmr = setInterval(get_status, 5000);

      function get_status()
      {

        if (_flag == 1)
        {

          _flag = 0;

          // helper function for getting token values
          function getTokenValue(paramPage, tokenId, successFn, failFn) {
            $.ajax({
              "type": "GET",
              "url": paramPage,
              "cache": false,
              "dataType": "html"
            })
                    // define callback for get request success
                    .done(function(getdata, status, xhr) {
                      successFn($(getdata).filter('#' + tokenId).text());
                    })
                    .fail(function(jqxhr, settings, exception) {
                      failFn();
                    });

          }


          getTokenValue('param_status.html', 'Device_Status',
                  // successFn callback, val is the token value
                          function(val) {
                            if (val == "TRUE") {
                              _flag = 0;
                              alert("Successfully Connected to AP!!");
                              location.reload();


                            } else {
                              if (val == "FALSE")
                              {

                                alert("Connection to AP Failed or Taking too long, Check Security Key and Retry");
                                location.reload();
                              }
                              else
                              {
                                alert("Rechecking Status..");
                                if (_count > 2)
                                {
                                  alert("AP Connection Status Check Failed - Reconnect and Refresh the page");
                                  _flag = 0;
                                }
                                else
                                {
                                  _flag = 1;
                                }
                              }
                            }
                          },
                          // failFn callback
                                  function() {
                                    if (_count < 3)
                                    {
                                      alert("Oops..It Seems Connection to Device AP is lost, Reconnect and wait for Notification");
                                      _flag = 1;

                                    }
                                    else
                                    {
                                      //if(_flag == 1)
                                      //{
                                      alert("AP Connection Status Check Failed - Reconnect and Refresh the page");
                                      //}

                                    }
                                  });
                          _count++;
                        }
              }

      function on_submit()
      {
        alert("Checking Status..");
        _count = 0;
        _flag = 1;

      }

      function SwitchAP()
      {
        alert("Switching to Station Mode..Connection to the Device AP will be Lost!!");
      }


    </script>
  </head>

  <body class="in-frame">
    <table border="0"  width="100%" cellpadding="3" cellspacing="0">

      <tr>  
        <td class="page-title" >
          WiFi Connectivity Profiles Settings </td>
        <td class = "page-title alert"> __SL_G_S.I </td>	
      </tr>

      <form id="SimpleLink_Configuration" action = "/" >  
        <tr>
          <td class = "empty-line" colspan=2></td>
        </tr>

        <tr>
          <td class="frame-title" colspan=2 > 
            Add Profile </td>
        </tr>

        <tr>
          <td class = "empty-l-in-box" colspan=2></td>
        </tr>

        <tr>
          <td class="label" dir=LTR> SSID: </td>
          <td class="user-input" dir=LTR><input type="radio" name="__SL_P_USD" value ="__SL_G_US1" >   __SL_G_US1 </input><br>
            <input type="radio" name="__SL_P_USD" value ="__SL_G_US2" >   __SL_G_US2 </input><br>
            <input type="radio" name="__SL_P_USD" value ="__SL_G_US3" >   __SL_G_US3 </input><br>
            <input type="radio" name="__SL_P_USD" value ="__SL_G_US4" >   __SL_G_US4 </input><br>
            <input type="radio" name="__SL_P_USD" value ="__SL_G_US5" >   __SL_G_US5 </input><br>
			<input type="radio" name="__SL_P_USD" value ="" > Other:<input type="text" name="other_ssid" /></input></td>
        </tr>

        <tr>
          <td class="label"> Security Type: </td>
          <td class="user-input"><input type="radio" name="__SL_P_USE" value="0" checked />Open
            <input type="radio" name="__SL_P_USE" value="1" />WEP
            <input type="radio" name="__SL_P_USE" value="2" />WPA								  
        </tr>
        <tr>
          <td class="label"> Security Key: </td>
          <td class="user-input"><input type="text" maxlength="64" name="__SL_P_USF" />  Hexadecimal digits - any combination of 0-9, a-f and A-F</td>
        </tr>
        <tr>
          <td class="label"> Profile Priority: </td>
          <td class="user-input"><input type="text" maxlength="1" name="__SL_P_USG" />  Enter a value 0-7 (0 = highest)</td>
        </tr>

        <tr>
          <td class="empty-l-in-box" colspan=2></td>
        </tr>

        <tr>
          <td class="in-a-box" colspan=2  align=center><input type="submit" name="__SL_P_USC" value="Add" /></td>
        </tr>

        <tr>
          <td class="in-a-box" colspan=2 align=center> Connection with the Access Point will be validated</td>
        </tr>

        <tr>
          <td class = "empty-l-in-box" colspan=2></td>
        </tr>

        <tr >
          <td class = "border-l-top" colspan=2 >
          </td>
        </tr>

      </form>

    </table>

    <table border="0"  width="100%" cellpadding="3" cellspacing="0">

      <form method="POST" name="SimpleLink Configuration" action="remove_selected_profiles">
        <input type="hidden" name="__SL_P_S.R" value="profiles_config.html"> <!-- Redirect -->
        <tr>
          <td class = "empty-line" colspan=3></td>
        </tr>

        <tr>
          <td class="frame-title" colspan=3 > 
            Profiles </td>
        </tr>
        <tr>
          <td class = "empty-l-in-box" colspan=3></td>
        </tr>

        <tr>
          <td  class="l_first_col" ><input type="checkbox" name="__SL_P_PRR" value="1" /> 1. <b> __SL_G_PN1 </b> </td> <td class = "l_middle_col"> Security: <b>__SL_G_PS1 </b> </td> <td class="l_last_col"> Priority: <b> __SL_G_PP1 </b> </td>
        </tr>

        <tr>
          <td  class="l_first_col" ><input type="checkbox" name="__SL_P_PRR" value="2" /> 2. <b> __SL_G_PN2 </b> </td> <td class = "l_middle_col"> Security: <b>__SL_G_PS2 </b> </td> <td class="l_last_col"> Priority: <b> __SL_G_PP2 </b> </td>
        </tr>
        <tr>
          <td  class="l_first_col" ><input type="checkbox" name="__SL_P_PRR" value="3" /> 3. <b> __SL_G_PN3 </b> </td> <td class = "l_middle_col"> Security: <b>__SL_G_PS3 </b> </td> <td class="l_last_col"> Priority: <b> __SL_G_PP3 </b> </td>
        </tr>
        <tr>
          <td  class="l_first_col" ><input type="checkbox" name="__SL_P_PRR" value="4" /> 4. <b> __SL_G_PN4 </b> </td> <td class = "l_middle_col"> Security: <b>__SL_G_PS4 </b> </td> <td class="l_last_col"> Priority: <b> __SL_G_PP4 </b> </td>
        </tr>
        <tr>
          <td  class="l_first_col" ><input type="checkbox" name="__SL_P_PRR" value="5" /> 5. <b> __SL_G_PN5 </b> </td> <td class = "l_middle_col"> Security: <b>__SL_G_PS5 </b> </td> <td class="l_last_col"> Priority: <b> __SL_G_PP5 </b> </td>
        </tr>
        <tr>
          <td  class="l_first_col" ><input type="checkbox" name="__SL_P_PRR" value="6" /> 6. <b> __SL_G_PN6 </b> </td> <td class = "l_middle_col"> Security: <b>__SL_G_PS6 </b> </td> <td class="l_last_col"> Priority: <b> __SL_G_PP6 </b> </td>
        </tr>
        <tr>
          <td  class="l_first_col" ><input type="checkbox" name="__SL_P_PRR" value="7" /> 7. <b> __SL_G_PN7 </b> </td> <td class = "l_middle_col"> Security: <b>__SL_G_PS7 </b> </td> <td class="l_last_col"> Priority: <b> __SL_G_PP7 </b> </td>
        </tr>
        <tr>
          <td class = "empty-l-in-box" colspan=3></td>
        </tr>

        <tr>
          <td class="in-a-box" colspan=3  align=center><input type="submit" value="Remove Selected Profiles" /></td>
        </tr>

        <tr>
          <td class = "empty-l-in-box" colspan=3></td>
        </tr>
        <tr >
          <td class = "border-l-top" colspan=3 >
          </td>
        </tr>
      </form>
    </table>

    <script>
      var escapable = /[\\\"\x00-\x1f\x7f-\uffff]/g,
              meta = {// table of character substitutions
                '\b': '\\b',
                '\t': '\\t',
                '\n': '\\n',
                '\f': '\\f',
                '\r': '\\r',
                '"': '\\"',
                '\\': '\\\\'
              };

      function quote(string) {

// If the string contains no control characters, no quote characters, and no
// backslash characters, then we can safely slap some quotes around it.
// Otherwise we must also replace the offending characters with safe escape
// sequences.

        escapable.lastIndex = 0;
        return escapable.test(string) ?
                '"' + string.replace(escapable, function(a) {
                  var c = meta[a];
                  return typeof c === 'string' ? c :
                          '\\u' + ('0000' + a.charCodeAt(0).toString(16)).slice(-4);
                }) + '"' :
                '"' + string + '"';
      }

      $("#SimpleLink_Configuration").submit(function(event) {

        event.preventDefault();

        var $form = $(this), url = $form.attr("action");
		$('input.__SL_P_USF').val(quote($('input.__SL_P_USF').val()));
		var postData = $form.serializeArray();
				
		postData.push({ name: "__SL_P_USC", value: "Add"});
		
		
        $.post(url, postData);

      });
    </script>

  </body>
</html>